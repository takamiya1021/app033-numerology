# 📋 要件定義書：No.33「数秘術風占い」

**作成日**: 2025-01-13
**バージョン**: 1.0
**アプリ番号**: 33

---

## 1. プロジェクト概要

### 1.1 アプリ名
**数秘術風占い（Numerology Fortune）**

### 1.2 目的・課題
- **解決したい課題**: 退屈しのぎ、面白おかしく楽しむ
- **ターゲットユーザー**: 占いを気軽に楽しみたい人
- **利用シーン**: お遊び感覚、エンターテインメント
- **コンセプト**: 真剣な占いではなく、遊び気分で楽しむ数秘術

### 1.3 成功基準
- 誕生日から数字を導く過程が面白い
- 神秘的な雰囲気で没入感がある
- AIによる解説・メッセージが楽しい
- 既存占い系アプリとの連携で価値向上

---

## 2. 必須要件（中期以降の方針）

### 2.1 AI内蔵アプリケーション
- ✅ Google AI Studio API使用（31番・32番と同じ）
- ✅ 数秘術の詳しい解説生成
- ✅ その数字に合わせたメッセージ生成
- ✅ アドバイス・行動指針生成

### 2.2 PWA標準実装
- ✅ オフライン対応
  - **数秘術計算**: オフラインでも動作
  - **AI生成**: オンライン必須
- ✅ インストール可能
- ✅ レスポンシブデザイン

### 2.3 既存アプリとの連携
- ✅ **9番「ラッキーカラー占い」と連携**
  - 数秘術の数字から適切なラッキーカラーを提案
  - 共通ナビゲーション
- ✅ **10番「相性診断」と連携**
  - 名前×名前の相性診断と統合
  - 数秘術ベースの相性判定
- ✅ **11番「星座占い」と連携**
  - 占い系アプリ全体の統合
  - 共通デザインシステム

---

## 3. 機能仕様

### 3.1 コア機能

#### 3.1.1 誕生日入力
- **入力方式**: カレンダー選択
- **名前入力**: オプション（任意）
- **デフォルト**: 今日の日付

#### 3.1.2 数秘術計算
- **計算方法**: 誕生日の各桁を足して1桁になるまで
- **計算例**:
  ```
  1985年1月23日
  → 1+9+8+5+1+2+3 = 29
  → 2+9 = 11（マスターナンバー）
  または
  → 1+1 = 2（さらに1桁に）
  ```
- **対象数字**:
  - 基本: 1〜9
  - マスターナンバー: 11, 22, 33（※これらは1桁にしない）
- **計算過程表示**: 簡単なアニメーションで表示

#### 3.1.3 表示情報

**1. ライフパスナンバー（運命数）**
- 計算結果の数字（1〜9, 11, 22, 33）
- その数字の基本的な意味

**2. 性格診断**
- その数字が持つ性格的特徴
- 長所・短所
- 向いている職業・生き方

**3. 今日の運勢**
- その日の運勢（数秘術的解釈）
- ラッキーアクション

**4. ラッキーナンバー**
- その日のラッキーナンバー
- 数字の組み合わせ提案

**5. 相性診断**
- 2人の誕生日を入力
- 数秘術ベースの相性スコア
- 相性の良い点・注意点

**6. 計算過程**
- どのように数字が導かれたか
- ステップバイステップ表示（簡単でOK）

#### 3.1.4 AI生成コンテンツ（Google AI Studio）
- **生成タイミング**: 生成ボタンを押した時（手動トリガー）
- **キャッシュ**: 利用しない（毎回新しいコンテンツを生成）
- **生成内容**:
  1. **数秘術の詳しい解説**
     - その数字の深い意味
     - 歴史的・文化的背景
  2. **その数字に合わせたメッセージ**
     - パーソナライズされたメッセージ
     - 励まし・応援
  3. **アドバイス・行動指針**
     - 今日やると良いこと
     - 意識すべきポイント

### 3.2 データ保存（ローカルストレージ）
- 過去の診断履歴（最新10件）
- お気に入りの診断結果
- APIキー（ユーザー設定）

---

## 4. 非機能要件

### 4.1 デザイン要求
- **テーマ**: 神秘的な雰囲気、占いらしさ
- **色使い**:
  - メインカラー: 紫系（#6B46C1, #7C3AED等）
  - アクセント: 金色（#FFD700, #F59E0B等）
  - 背景: 深い紫〜黒のグラデーション
- **アニメーション**:
  - 数字が導かれる過程（フェードイン・カウントアップ）
  - キラキラエフェクト
  - スムーズなトランジション
- **フォント**: 神秘的で読みやすいフォント

### 4.2 パフォーマンス
- 初回表示: 2秒以内
- 計算: 瞬時（100ms以内）
- AI生成: バックグラウンド実行、ローディング表示

### 4.3 互換性
- モダンブラウザ（Chrome, Edge, Safari, Firefox最新版）
- モバイル・タブレット対応
- PWAとしてインストール可能

---

## 5. 技術制約

### 5.1 使用API
- **Google AI Studio API**
  - モデル: Gemini Pro推奨
  - APIキー管理: ユーザー入力 + ローカルストレージ
  - 31番・32番と共通

### 5.2 データ保存
- **ローカルストレージ**
  - 容量制限: 5MB以内
  - データ構造: JSON形式

### 5.3 数秘術計算
- 純粋なJavaScript実装（ライブラリ不要）
- マスターナンバー判定ロジック

---

## 6. 画面構成

### 6.1 メイン画面
```
┌─────────────────────────────────────┐
│  🔮 数秘術風占い                     │
├─────────────────────────────────────┤
│  📅 誕生日: [カレンダー選択]         │
│  👤 名前: [オプション入力]           │
│  [✨ 占う ボタン]                    │
├─────────────────────────────────────┤
│  【計算過程アニメーション】           │
│  1+9+8+5+1+2+3 = 29                │
│  2+9 = 11 ✨                        │
├─────────────────────────────────────┤
│  🎯 あなたのライフパスナンバー        │
│       【 11 】                      │
│  （マスターナンバー）                │
├─────────────────────────────────────┤
│  📊 性格診断:                        │
│  [基本的な性格特徴]                  │
├─────────────────────────────────────┤
│  🌟 今日の運勢:                      │
│  [運勢メッセージ]                    │
├─────────────────────────────────────┤
│  🍀 ラッキーナンバー: 3, 7, 11       │
├─────────────────────────────────────┤
│  [✨ AI詳細解説を生成 ボタン]         │
├─────────────────────────────────────┤
│  💡 詳しい解説:                      │
│  [AI生成コンテンツ]                  │
├─────────────────────────────────────┤
│  💌 あなたへのメッセージ:             │
│  [AI生成コンテンツ]                  │
├─────────────────────────────────────┤
│  🎯 行動指針:                        │
│  [AI生成コンテンツ]                  │
└─────────────────────────────────────┘
```

### 6.2 相性診断画面
```
┌─────────────────────────────────────┐
│  💕 相性診断                         │
├─────────────────────────────────────┤
│  👤 あなたの誕生日: [カレンダー]     │
│  👥 相手の誕生日: [カレンダー]       │
│  [✨ 相性を占う ボタン]              │
├─────────────────────────────────────┤
│  💯 相性スコア: 85%                  │
│  ⭐⭐⭐⭐☆                           │
├─────────────────────────────────────┤
│  💖 相性の良い点:                    │
│  [解説]                              │
├─────────────────────────────────────┤
│  ⚠️ 注意点:                         │
│  [アドバイス]                        │
└─────────────────────────────────────┘
```

### 6.3 設定画面
- APIキー入力
- 診断履歴表示
- データクリア
- アプリ情報

---

## 7. 開発スコープ外（将来拡張）

- 月運・年運の計算
- 複雑な数秘術（ソウルナンバー、パーソナリティナンバー等）
- ソーシャル共有機能
- 有料プレミアム診断

---

## 8. リスクと対策

### 8.1 技術リスク
| リスク | 対策 |
|--------|------|
| マスターナンバー判定の複雑性 | 明確なロジック定義、テストケース充実 |
| アニメーションパフォーマンス | CSS/JS最適化 |
| AI生成の遅延 | ローディング表示、タイムアウト設定 |

### 8.2 運用リスク
| リスク | 対策 |
|--------|------|
| APIキー未設定時のUX | デモモード・プレースホルダー表示 |
| 占い系アプリ統合の複雑さ | 段階的に連携実装 |

---

## 9. 既存占い系アプリとの連携

### 9.1 連携対象
- **9番「ラッキーカラー占い」**
  - 数秘術の数字から適切なラッキーカラーを提案
  - 「あなたのライフパスナンバーに合うラッキーカラーは〇〇です」
- **10番「相性診断」**
  - 名前×名前の相性診断と統合
  - 数秘術ベースの相性判定を追加
- **11番「星座占い」**
  - 星座 × 数秘術の複合診断

### 9.2 共通化要素
- 神秘的なデザインシステム（紫・金色）
- 共通ナビゲーション
- AI生成機能の共通化
- ローカルストレージ管理

---

## 10. 数秘術の数字の意味（基本定義）

| 数字 | 基本的な意味 |
|------|------------|
| 1 | リーダーシップ、独立心、創造性 |
| 2 | 協調性、バランス、感受性 |
| 3 | 表現力、社交性、楽観性 |
| 4 | 安定性、実直、努力家 |
| 5 | 自由、冒険、変化 |
| 6 | 愛情、責任感、調和 |
| 7 | 知性、探究心、スピリチュアル |
| 8 | 成功、権力、物質的豊かさ |
| 9 | 完成、普遍的愛、人道主義 |
| 11 | 直感、インスピレーション（マスターナンバー） |
| 22 | 実現力、大きな夢（マスターナンバー） |
| 33 | 無条件の愛、奉仕（マスターナンバー） |

---

## 11. 次ステップ

1. ✅ 要件定義書レビュー・承認
2. ⬜ 技術設計書作成
3. ⬜ 実装計画書作成
4. ⬜ 実装開始（Claude Code on the Web）

---

**作成者**: クロ
**レビュー待ち**: あおいさん
